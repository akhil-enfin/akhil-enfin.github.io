{"version":3,"sources":["components/Privacy.js","components/TermsOfUse.js","components/Tab.js","components/Auth.js","components/Mycourses.js","components/App.js","index.js"],"names":["Privacy","React","Component","TermsOfUse","localStorage","getItem","Tab","props","state","context","console","log","window","location","origin","microsoftTeams","error","setState","authenticate","url","width","height","successCallback","result","href","failureCallback","reason","userName","Object","keys","this","length","onClick","openLogin","axios","require","Auth","values","errors","condition","sent_data","inputhandle","field","e","target","value","validate","fields","formIsValid","match","lastAtPos","lastIndexOf","lastDotPos","indexOf","formsSub","preventDefault","login","setTimeout","className","userData","i","headers","post","then","response","setItem","JSON","stringify","catch","notifySuccess","accessToken","style","margin","textAlign","alt","src","background","onSubmit","type","name","onChange","bind","email","Mucourses","App","exact","path","component","Mycourses","ReactDOM","render","Provider","theme","themes","teams","document","getElementById"],"mappings":"yUAqBeA,E,uKART,OACE,6BACE,sD,GAJYC,IAAMC,WCsBbC,E,oNAhBX,OAD4C,OAAlCC,aAAaC,QAAQ,SAG3B,6BACE,8CAMF,6BACE,iD,GAhBeJ,IAAMC,WCsDhBI,E,kDArDb,WAAYC,GAAO,IAAD,8BAChB,cAAMA,IACDC,MAAQ,CACXC,QAAS,IAHK,E,gEASE,IAAD,OAEjBC,QAAQC,IAAIC,OAAOC,SAASC,OAAO,YACnCC,cAA0B,SAACN,EAASO,GAClCN,QAAQC,IAAIF,EAAQ,WACpB,EAAKQ,SAAS,CACZR,QAASA,S,kCAMbM,iBAA8BG,aAAa,CAEzCC,IAAIP,OAAOC,SAASC,OAAS,QAC7BM,MAAO,IACPC,OAAQ,IACRC,gBAAiB,SAAUC,GAEzBb,QAAQC,IAAIY,EAAO,UACnBX,OAAOC,SAASW,KAAO,YAGzBC,gBAAiB,SAAUC,GAEzBhB,QAAQC,IAAIe,EAAO,OACnBd,OAAOC,SAASW,KAAO,gB,+BAKnB,IAAD,OAEDG,EAAWC,OAAOC,KAAKC,KAAKtB,MAAMC,SAASsB,OAAS,EAAID,KAAKtB,MAAMC,QAAX,IAA4B,GAExF,OACA,6BACE,4CACA,+CAAqBkB,EAArB,KAFF,IAEuC,4DACrC,4BAAQK,QAAS,kBAAM,EAAKC,cAA5B,gB,GAjDUhC,IAAMC,W,2BCTlBgC,EAAQC,EAAQ,KACDC,E,4MACnB5B,MAAQ,CACN6B,OAAQ,GACRC,OAAQ,GACRC,UAAW,GACXC,UAAW,I,EAcbC,YAAc,SAACC,EAAOC,GACJ,EAAKnC,MAAM6B,OACjBK,GAASC,EAAEC,OAAOC,O,EAI9BC,SAAW,WACT,IAAIC,EAAS,EAAKvC,MAAM6B,OACpBC,EAAS,GACTU,GAAc,EAclB,GAZKD,EAAM,KAGCA,EAAM,KAASE,MAAM,uBAC/BD,GAAc,EACdV,EAAM,KAAW,wBAJjBU,GAAc,EACdV,EAAM,KAAW,4BAMdS,EAAM,QACTC,GAAc,EACdV,EAAM,MAAY,yBAEW,qBAApBS,EAAM,MAA2B,CAC1C,IAAIG,EAAYH,EAAM,MAAUI,YAAY,KACxCC,EAAaL,EAAM,MAAUI,YAAY,KAEvCD,EAAYE,GAAcF,EAAY,IAAwC,IAAnCH,EAAM,MAAUM,QAAQ,OAAgBD,EAAa,GAAML,EAAM,MAAUhB,OAASqB,EAAc,IACjJJ,GAAc,EACdV,EAAM,MAAY,sBAItB,OADA,EAAKrB,SAAS,CAAEqB,OAAQA,IACjBU,G,EAGTM,SAAW,SAACX,GACVA,EAAEY,iBACc,EAAKT,YAEnBpC,QAAQC,IAAI,EAAKH,MAAM6B,QACvB,EAAKmB,MAAM,EAAKhD,MAAM6B,UAEtBoB,YAAW,WACT,EAAKxC,SAAS,CAAEsB,UAAW,OAC1B,KACH,EAAKtB,SAAS,CACZsB,UACE,yBAAKmB,UAAU,gDACb,0D,4KA1DR3C,e,sKAgEU4C,G,gFACVjD,QAAQC,IAAIgD,GACRC,EAAI,CACN,cAAiB,+CACjB,iBAAoB,gBAEhBC,EAAU,CACd,cAAiB,uhB,SAGb3B,EAAM4B,KAAK,6DAA8DF,EAAG,CAChFC,QAASA,IAERE,MAAK,SAACC,GACLtD,QAAQC,IAAIqD,GACZ5D,aAAa6D,QAAQ,QAASC,KAAKC,UAAUH,OAE9CI,OAAM,SAACpD,GACNZ,aAAa6D,QAAQ,QAASC,KAAKC,UAAUnD,IAC7CN,QAAQC,IAAIK,M,OAEhBD,iBAA8BsD,cAAc,CAAEC,YAAa,sB,iIAI3D,OACE,yBAAKC,MAAO,CAAEC,OAAQ,OAAQC,UAAW,UAAYf,UAAU,IAC7D,yBAAKgB,IAAI,OAAOC,IAAI,uCAAuCJ,MAAO,CAAEK,WAAY,aAChF,6BAAM9C,KAAKtB,MAAM+B,WACjB,0BAAMsC,SAAU/C,KAAKwB,UACnB,gDACQ,6BACR,2BAAOwB,KAAK,OAAOC,KAAK,QAAQC,SAAUlD,KAAKW,YAAYwC,KAAKnD,KAAM,WACtE,uBAAG4B,UAAU,eAAe5B,KAAKtB,MAAM8B,OAAO4C,OAC9C,mDALF,IAMW,6BACT,2BAAOJ,KAAK,WAAWC,KAAK,OAAOC,SAAUlD,KAAKW,YAAYwC,KAAKnD,KAAM,UACzE,uBAAG4B,UAAU,eAAe5B,KAAKtB,MAAM8B,OAAOyC,MAK9C,4BAAQD,KAAK,SAASpB,UAAU,mBAAhC,gB,GApHwBzD,IAAMC,WCuCzBiF,E,4MA9Bb3E,MAAQ,CACNmD,SAAU,I,kEAIV7B,KAAKb,SAAS,CAAE0C,SAAUvD,aAAaC,QAAQ,a,+BAI/C,OAA4B,OAAxByB,KAAKtB,MAAMmD,SAEX,6BACE,gDACA,oCACGO,KAAKC,UAAUrC,KAAKtB,MAAMmD,SAAU,KAAM,KAS/C,6BACE,mD,GAzBc1D,IAAMC,WCwBfkF,MAjBf,WAME,OAHArE,eAIE,kBAAC,IAAD,KACE,kBAAC,IAAD,CAAOsE,OAAK,EAACC,KAAK,WAAWC,UAAWvF,IACxC,kBAAC,IAAD,CAAOqF,OAAK,EAACC,KAAK,cAAcC,UAAWpF,IAC3C,kBAAC,IAAD,CAAOkF,OAAK,EAACC,KAAK,OAAOC,UAAWjF,IACpC,kBAAC,IAAD,CAAO+E,OAAK,EAACC,KAAK,QAAQC,UAAWnD,IACrC,kBAAC,IAAD,CAAOiD,OAAK,EAACC,KAAK,WAAWC,UAAWC,M,kBCrB9CC,IAASC,OACL,kBAACC,EAAA,EAAD,CAAUC,MAAOC,SAAOC,OACpB,kBAAC,EAAD,OACSC,SAASC,eAAe,W","file":"static/js/main.c9012a3e.chunk.js","sourcesContent":["// Copyright (c) Microsoft Corporation. All rights reserved.\r\n// Licensed under the MIT License.\r\n\r\nimport React from 'react';\r\nimport './App.css';\r\n\r\n/**\r\n * This component is used to display the required\r\n * privacy statement which can be found in a link in the\r\n * about tab.\r\n */\r\nclass Privacy extends React.Component {\r\n    render() {\r\n      return (\r\n        <div>\r\n          <h1>Privacy Statement</h1>\r\n        </div>\r\n      );\r\n    }\r\n}\r\n\r\nexport default Privacy;","// Copyright (c) Microsoft Corporation. All rights reserved.\r\n// Licensed under the MIT License.\r\n\r\nimport React from 'react';\r\nimport './App.css';\r\n\r\n/**\r\n * This component is used to display the required\r\n * terms of use statement which can be found in a\r\n * link in the about tab.\r\n */\r\nclass TermsOfUse extends React.Component {\r\n  componentDidMount() {\r\n\r\n  }\r\n  render() {\r\n    let val = localStorage.getItem('token') !== null\r\n    if (val) {\r\n      return (\r\n        <div>\r\n          <h1>login success</h1>\r\n        </div>\r\n      )\r\n    }\r\n    else\r\n      return (\r\n        <div>\r\n          <h1>Terms of Use</h1>\r\n        </div>\r\n      );\r\n  }\r\n}\r\n\r\nexport default TermsOfUse;","// Copyright (c) Microsoft Corporation. All rights reserved.\r\n// Licensed under the MIT License.\r\n\r\nimport React from 'react';\r\nimport './App.css';\r\nimport * as microsoftTeams from \"@microsoft/teams-js\";\r\n\r\n/**\r\n * The 'PersonalTab' component renders the main tab content\r\n * of your app.\r\n */\r\nclass Tab extends React.Component {\r\n  constructor(props){\r\n    super(props)\r\n    this.state = {\r\n      context: {}\r\n    }\r\n  }\r\n\r\n  //React lifecycle method that gets called once a component has finished mounting\r\n  //Learn more: https://reactjs.org/docs/react-component.html#componentdidmount\r\n  componentDidMount(){\r\n    // Get the user context from Teams and set it in the state\r\n    console.log(window.location.origin,'location')\r\n    microsoftTeams.getContext((context, error) => {\r\n      console.log(context,'context')\r\n      this.setState({\r\n        context: context\r\n      });\r\n    });\r\n    // Next steps: Error handling using the error object\r\n  }\r\n  openLogin() {\r\n    microsoftTeams.authentication.authenticate({\r\n      // url: window.location.origin + \"/auth\",\r\n      url:window.location.origin + '/auth',\r\n      width: 600,\r\n      height: 535,\r\n      successCallback: function (result) {\r\n        // getUserProfile(result.accessToken);\r\n        console.log(result,'result')\r\n        window.location.href = \"/courses\"\r\n        \r\n      },\r\n      failureCallback: function (reason) {\r\n        // handleAuthError(reason);\r\n        console.log(reason,'err')\r\n        window.location.href = \"/courses\"\r\n\r\n      }\r\n    });\r\n  }\r\n  render() {\r\n\r\n      let userName = Object.keys(this.state.context).length > 0 ? this.state.context['upn'] : \"\";\r\n\r\n      return (\r\n      <div>\r\n        <h3>Hello World!</h3>\r\n        <h1>Congratulations {userName}!</h1> <h3>This is the tab you made :-)</h3>\r\n        <button onClick={() => this.openLogin()}> Login </button>\r\n      </div>\r\n      );\r\n  }\r\n}\r\nexport default Tab;","import React from 'react';\r\nimport * as microsoftTeams from \"@microsoft/teams-js\";\r\nconst axios = require('axios')\r\nexport default class Auth extends React.Component {\r\n  state = {\r\n    values: {},\r\n    errors: {},\r\n    condition: '',\r\n    sent_data: {}\r\n\r\n    // addValues:null\r\n  }\r\n  async componentDidMount() {\r\n    microsoftTeams.initialize();\r\n\r\n    // let sent_data = this.state.sent_data;\r\n    // sent_data['response']=\"123\"\r\n    // sent_data['gmail']=\"123@gmail\"\r\n    // sent_data['imageurl']=\"https://i1.fnp.com/images/pr/l/romancing-roses-n-daisies_1.jpg\"\r\n\r\n\r\n  }\r\n  inputhandle = (field, e) => {\r\n    let addValues = this.state.values;\r\n    addValues[field] = e.target.value\r\n\r\n  }\r\n\r\n  validate = () => {\r\n    let fields = this.state.values;\r\n    let errors = {};\r\n    let formIsValid = true;\r\n    //name\r\n    if (!fields['name']) {\r\n      formIsValid = false;\r\n      errors['name'] = \"Password cannot be empty\"\r\n    } else if (!fields['name'].match(/^[a-zA-Z ]{2,30}$/)) {\r\n      formIsValid = false;\r\n      errors['name'] = \"numbers not allowed\"\r\n    }\r\n    //email\r\n    if (!fields[\"email\"]) {\r\n      formIsValid = false;\r\n      errors[\"email\"] = \"Email cannot be empty\";\r\n    }\r\n    if (typeof fields[\"email\"] !== \"undefined\") {\r\n      let lastAtPos = fields[\"email\"].lastIndexOf('@');\r\n      let lastDotPos = fields[\"email\"].lastIndexOf('.');\r\n\r\n      if (!(lastAtPos < lastDotPos && lastAtPos > 0 && fields[\"email\"].indexOf('@@') === -1 && lastDotPos > 2 && (fields[\"email\"].length - lastDotPos) > 2)) {\r\n        formIsValid = false;\r\n        errors[\"email\"] = \"Email is not valid\";\r\n      }\r\n    }\r\n    this.setState({ errors: errors });\r\n    return formIsValid;\r\n  }\r\n\r\n  formsSub = (e) => {\r\n    e.preventDefault();\r\n    const isValid = this.validate()\r\n    if (isValid) {\r\n      console.log(this.state.values)\r\n      this.login(this.state.values)\r\n    } else {\r\n      setTimeout(() => {\r\n        this.setState({ condition: \"\" })\r\n      }, 3000)\r\n      this.setState({\r\n        condition:\r\n          <div className=\"alert alert-danger alert-dismissible fade in\">\r\n            <strong>Validation error!</strong>\r\n          </div>\r\n      })\r\n    }\r\n  }\r\n\r\n  async login(userData) {\r\n    console.log(userData)\r\n    let i = {\r\n      \"learner_email\": \"dGhhbnZlZXIuYUBlbmZpbnRlY2hub2xvZ2llcy5jb20=\",\r\n      \"learner_password\": \"MTIzNDU2YWI=\"\r\n    }\r\n    const headers = {\r\n      'Authorization': 'mykademy microsoft-teams-app:NGNKNpN_No7BNCNGNM7tNtNmNrNT7k7-N6NONxNN76N77lNW79NjN.NSNTNRNr79NDNz7lNCNeN7NTNDNjNc7Z7Q7HNwN-Np7y7ZNc70NG7J7JNJNvN6NKNe7f7f79NGNjNR3661646239366166626232653463623963653830393936303361336536613364jp7kj8jiNcNKNmNCN87DNG7kjGjbNtN-jPj6jKN2Nq7uNjN7NqjXjojGjVjCjwN47BNYN4jqNYNBjmjAN9NINd7M7rNDjWjKN_j7NFNGj8N_NnjpjgNANP7yNFNkN6jKNfN6jqjXjLjbjcNyjnjpNqN8jgNlNpNW7vNojnjMjgNrNiNYN-jeN9jNjxjQjzjCj0Nxjhjj70NT7YNijsNkNfjNNqNhNmNJjsjxNxNYNvNgjE7C7pNCjAjiNHjeNtNONUjpN9jtj8NIjWjAjqNZNmN3NN7IjsNBjpjTNtN-joj.jW7yNJ'\r\n    }\r\n\r\n    await axios.post('https://dev.mykademy.com/mykademy/api/v1/authenticate_user', i, {\r\n      headers: headers\r\n    })\r\n      .then((response) => {\r\n        console.log(response)\r\n        localStorage.setItem('token', JSON.stringify(response))\r\n      })\r\n      .catch((error) => {\r\n        localStorage.setItem('token', JSON.stringify(error))\r\n        console.log(error)\r\n      })\r\n    microsoftTeams.authentication.notifySuccess({ accessToken: 'user.access_token' })\r\n  }\r\n\r\n  render() {\r\n    return (\r\n      <div style={{ margin: 'auto', textAlign: 'center' }} className=\"\">\r\n        <img alt=\"icon\" src=\"https://mykademy.com/images/logo.png\" style={{ background: '#11100f' }} />\r\n        <div>{this.state.condition}</div>\r\n        <form onSubmit={this.formsSub}>\r\n          <label>Learner Email\r\n          </label><br />\r\n          <input type=\"text\" name=\"email\" onChange={this.inputhandle.bind(this, \"email\")}></input>\r\n          <p className=\"text-danger\">{this.state.errors.email}</p>\r\n          <label>Learner Password\r\n          </label> <br />\r\n          <input type=\"password\" name=\"name\" onChange={this.inputhandle.bind(this, \"name\")}></input>\r\n          <p className=\"text-danger\">{this.state.errors.name}</p>\r\n          {/* <label>password\r\n                        <input type=\"text\" name=\"password\" onChange={this.inputhandle}></input>\r\n                    </label><br /> */}\r\n          {/* <p className=\"text-danger\">{this.state.passwordError}</p> */}\r\n          <button type=\"submit\" className=\"btn btn-primary\">Submit</button>\r\n        </form>\r\n      </div >\r\n    )\r\n  }\r\n}","// Copyright (c) Microsoft Corporation. All rights reserved.\r\n// Licensed under the MIT License.\r\n\r\nimport React from 'react';\r\nimport './App.css';\r\n\r\n/**\r\n * This component is used to display the required\r\n * terms of use statement which can be found in a\r\n * link in the about tab.\r\n */\r\nclass Mucourses extends React.Component {\r\n  state = {\r\n    userData: {},\r\n  }\r\n  componentDidMount() {\r\n\r\n    this.setState({ userData: localStorage.getItem('token') })\r\n  }\r\n  render() {\r\n\r\n    if (this.state.userData !== null) {\r\n      return (\r\n        <div>\r\n          <h1>login response :</h1>\r\n          <>\r\n            {JSON.stringify(this.state.userData, null, 2)}\r\n          </>\r\n        </div>\r\n      )\r\n    }\r\n    else\r\n\r\n      return (\r\n\r\n        <div>\r\n          <h1>Please login!.</h1>\r\n        </div>\r\n      );\r\n  }\r\n}\r\n\r\nexport default Mucourses;","// Copyright (c) Microsoft Corporation. All rights reserved.\r\n// Licensed under the MIT License.\r\n\r\nimport React from 'react';\r\nimport './App.css';\r\nimport * as microsoftTeams from \"@microsoft/teams-js\";\r\nimport { BrowserRouter as Router, Route } from \"react-router-dom\";\r\n\r\nimport Privacy from \"./Privacy\";\r\nimport TermsOfUse from \"./TermsOfUse\";\r\nimport Tab from \"./Tab\";\r\nimport Auth from \"./Auth\";\r\nimport Mycourses from \"./Mycourses\";\r\n\r\n/**\r\n * The main app which handles the initialization and routing\r\n * of the app.\r\n */\r\nfunction App() {\r\n\r\n  // Initialize the Microsoft Teams SDK\r\n  microsoftTeams.initialize();\r\n\r\n  // Display the app home page hosted in Teams\r\n  return (\r\n    <Router>\r\n      <Route exact path=\"/privacy\" component={Privacy} />\r\n      <Route exact path=\"/termsofuse\" component={TermsOfUse} />\r\n      <Route exact path=\"/tab\" component={Tab} />\r\n      <Route exact path=\"/auth\" component={Auth} />\r\n      <Route exact path=\"/courses\" component={Mycourses} />\r\n    </Router>\r\n  );\r\n}\r\n\r\nexport default App;\r\n","// Copyright (c) Microsoft Corporation. All rights reserved.\r\n// Licensed under the MIT License.\r\n\r\nimport React from 'react';\r\nimport ReactDOM from 'react-dom';\r\nimport './index.css';\r\nimport App from './components/App';\r\nimport { Provider, themes } from '@fluentui/react-northstar' //https://fluentsite.z22.web.core.windows.net/quick-start\r\n\r\nReactDOM.render(\r\n    <Provider theme={themes.teams}>\r\n        <App />\r\n    </Provider>, document.getElementById('root')\r\n);\r\n"],"sourceRoot":""}